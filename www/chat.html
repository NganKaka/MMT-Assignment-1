<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Messenger Chat Hybrid</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .section-title { padding: 10px 15px; font-size: 12px; color: #666; font-weight: bold; background: #eee; text-transform: uppercase; }
        .input-group { padding: 10px; border-bottom: 1px solid #ddd; display: flex; }
        .input-group input { flex: 1; padding: 5px; border: 1px solid #ccc; border-radius: 3px; }
        .input-group button { margin-left: 5px; padding: 5px 10px; background: #0084ff; color: white; border: none; border-radius: 3px; cursor: pointer; }
        
        #channel-list, #peer-list { list-style: none; padding: 0; }
        .item-list { padding: 15px; cursor: pointer; border-bottom: 1px solid #f0f0f0; transition: 0.2s; }
        .item-list:hover { background-color: #f0f2f5; }
        .item-list.active { background-color: #e6f2ff; border-left: 4px solid #0084ff; font-weight: bold; }
        
        .channel-icon::before { content: 'ğŸ“¢ '; }
        .peer-icon::before { content: 'ğŸ‘¤ '; }
    </style>
</head>
<body>
    <div id="chat-screen">
        <div class="sidebar">
            <div class="sidebar-header">
                <h3>WeApRous Chat</h3>
            </div>
            
            <!-- Táº¡o/VÃ o KÃªnh -->
            <div class="input-group">
                <input type="text" id="new-channel-name" placeholder="Nháº­p tÃªn kÃªnh...">
                <button onclick="joinChannel()">VÃ o</button>
            </div>

            <div class="online-list-container">
                <div class="section-title">KÃªnh Chat</div>
                <ul id="channel-list"></ul>

                <div class="section-title">NgÆ°á»i dÃ¹ng Online</div>
                <ul id="peer-list"></ul>
            </div>
        </div>

        <div class="main-chat">
            <div class="chat-header">
                <div class="chat-info">
                    <h4 id="current-user-display">Äang táº£i...</h4>
                    <span class="active-status">â— Äang hoáº¡t Ä‘á»™ng</span>
                </div>
            </div>

            <div id="message-window" class="message-area">
                <div class="system-msg">ChÃ o má»«ng! HÃ£y chá»n ngÆ°á»i hoáº·c kÃªnh Ä‘á»ƒ chat.</div>
            </div>

            <div class="chat-footer">
                <input type="text" id="msg-input" placeholder="Nháº­p tin nháº¯n..." onkeypress="handleEnter(event)">
                <button class="send-btn" onclick="sendMessage()">Gá»­i</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        const user = localStorage.getItem('chat_username');
        if (!user) {
            window.location.href = "/login.html";
        } else {
            document.getElementById('current-user-display').innerText = `TÃ´i: ${user}`;
            startChatApp(user);
        }

        function handleEnter(e) {
            if (e.key === 'Enter') sendMessage();
        }
    </script>
</body>
</html>